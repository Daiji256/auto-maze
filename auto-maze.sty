%% This is file `auto-maze.sty'.
%% Copyright 2021 Daiji SUZUKI

\RequirePackage{expl3, xparse, l3keys2e}

\ExplSyntaxOn

\NewDocumentCommand \maze { }
  {
    \int_new:N \l_am_cnt_i_int
    \int_new:N \l_am_rand_int
    \seq_new:N \l_am_maze_seq

    \int_set:Nn \l_am_cnt_i_int { 0 }
    % first line
    \int_do_while:nn { \l_am_cnt_i_int < 5 }
      {
        \int_compare:nNnTF { \l_am_cnt_i_int } = { 0 }
          {
            \int_set:Nn \l_am_rand_int { \fp_eval:n { randint(0, 3) } }
            \seq_put_right:NV \l_am_maze_seq \l_am_rand_int
          }
          {
            \int_compare:nNnTF { \l_am_rand_int } = { 2 }
              {
                \int_set:Nn \l_am_rand_int { \fp_eval:n { randint(1, 3) } }
                \seq_put_right:NV \l_am_maze_seq \l_am_rand_int
              }
              {
                \int_set:Nn \l_am_rand_int { \int_eval:n { \fp_eval:n { randint(0, 3) } } }
                \seq_put_right:NV \l_am_maze_seq \l_am_rand_int
              }
          }
        \int_incr:N \l_am_cnt_i_int
      }

    \int_set:Nn \l_am_cnt_i_int { 0 }
    \int_do_while:nn { \l_am_cnt_i_int < 5 }
      {
        \int_incr:N \l_am_cnt_i_int
        \seq_pop_left:NN \l_am_maze_seq \l_am_maze_value_tl
        \l_am_maze_value_tl
      }
  }

\ExplSyntaxOff
